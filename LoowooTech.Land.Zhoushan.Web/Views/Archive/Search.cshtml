@{
    ViewBag.Title = "查询";
    DossierParameter parameter = ViewBag.Parameter;
    List<Dossier> list = ViewBag.List;
}

<div class="col-md-3 col-sm-3 col-xs-3 well" style="padding:0px;">
    <fieldset><legend >查询设置</legend></fieldset>
    <form method="get" id="Search-Dossier" action="/Archive/Search">
        <div class="row">
            <div class="col-md-12 col-xs-12 col-sm-12">
                <div class="form-group">
                    <label class="control-label">选择年份</label>
                    <div class="col-md-12">
                        <div class="input-group">
                            <input type="text" name="MinYear" class="form-control" placeholder="起始年" value="@(parameter.MinYear.HasValue?parameter.MinYear.Value.ToString():"")"/>
                            <span class="input-group-addon">至</span>
                            <input type="text" name="MaxYear" class="form-control" placeholder="截止年" value="@(parameter.MaxYear.HasValue?parameter.MaxYear.Value.ToString():"")"/>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label">选择季度</label>
                    <div class="col-md-12">
                        <input type="hidden" name="Quarter" value="@(parameter.Quarter)" />
                        <div class="btn-group">
                            <button type="button" class="btn btn-@(string.IsNullOrEmpty(parameter.Quarter)?"primary":"default")" name="Quarter">全部</button>
                            @foreach(Quarter quarter in Enum.GetValues(typeof(Quarter)))
                            {
                                <button type="button" class="btn btn-@(!string.IsNullOrEmpty(parameter.Quarter)&&quarter.GetDescription()==parameter.Quarter?"primary":"default")" name="Quarter">@(quarter.GetDescription())</button>
                            }
                        </div>
                    </div>
                </div>
                <hr />

                <div class="form-group">
                    <div class="col-md-12 col-xs-12 col-sm-12">
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary"><i class="glyphicon glyphicon-search"></i>立即查询</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="col-md-9 col-xs-9 col-sm-9">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>年份</th>
                <th>季度</th>
                <th>下载</th>
            </tr>
        </thead>
        <tbody>
            @foreach(var dossier in list)
            {
                <tr>
                    <td>@(dossier.Year)</td>
                    <td>@(dossier.Quarter.GetDescription())</td>
                    <td><a href="/@(dossier.FilePath)" class="btn btn-default btn-sm" data-target="#page" target="_blank">@(string.Format("{0}年{1}",dossier.Year,dossier.Quarter.GetDescription()))<i class="glyphicon glyphicon-download-alt"></i></a></td>
                </tr>
            }
        </tbody>
    </table>
</div>

<script>
    $(function () {
        $(".btn-group>button").click(function () {
            var name = $(this).attr("name");
            if (name == undefined) {
                return;
            }
            var val = $(this).text();
            if (val == "全部") {
                val = "";
            }
            $(".btn-group>button[name='" + name + "']").removeClass("btn-primary").addClass("btn-default");
            $(this).removeClass("btn-default").addClass("btn-primary");
            $("input[name='" + name + "']").val(val);
        });
    })
</script>

